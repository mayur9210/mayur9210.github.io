(self.webpackJsonp=self.webpackJsonp||[]).push([[2],Array(20).concat([function(e,t,n){"use strict";function i(e,t){for(const n in e)if(e[n]!==t[n])return!1;for(const n in t)if(!(n in e))return!1;return!0}function o(e,t){const n=e.getContext("2d");if(!n)throw Error("Canvas not initialized");n.clearRect(0,0,e.width,e.height),n.putImageData(t,0,0)}async function s(e,t,n){const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const o=i.getContext("2d");if(!o)throw Error("Canvas not initialized");let s;if(o.putImageData(e,0,0),"toBlob"in i)s=await new Promise(e=>i.toBlob(e,t,n));else{const e=i.toDataURL(t,n),o=/data:([^;]+);base64,(.*)$/.exec(e);if(!o)throw Error("Data URL reading failed");const r=o[1],a=atob(o[2]),c=new Uint8Array(a.length);for(let t=0;t<c.length;t+=1)c[t]=a.charCodeAt(t);s=new Blob([c],{type:r})}if(!s)throw Error("Encoding failed");return s}n.d(t,"p",function(){return i}),n.d(t,"h",function(){return o}),n.d(t,"g",function(){return s}),n.d(t,"f",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"q",function(){return h}),n.d(t,"b",function(){return p}),n.d(t,"i",function(){return b}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return g}),n.d(t,"m",function(){return m}),n.d(t,"k",function(){return f}),n.d(t,"j",function(){return v}),n.d(t,"l",function(){return O}),n.d(t,"n",function(){return y}),n.d(t,"r",function(){return _}),n.d(t,"o",function(){return j});const r=new Map;function a(e){if(!r.has(e)){const t=(async()=>{const t=document.createElement("picture"),n=document.createElement("img"),i=document.createElement("source");return i.srcset="data:,x",i.type=e,t.append(i,n),await 0,!!n.currentSrc})();r.set(e,t)}return r.get(e)}function c(e){return new Response(e).arrayBuffer()}function l(e){return new Response(e).text()}const u=new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"],[/^\x00\x00\x00 ftypavif\x00\x00\x00\x00/,"image/avif"]]);async function h(e){const t=await c(e.slice(0,16)),n=Array.from(new Uint8Array(t)).map(e=>String.fromCodePoint(e)).join("");for(const[i,o]of u)if(i.test(n))return o;return""}async function p(e){const t=URL.createObjectURL(e);try{return await async function(e){const t=new Image;t.decoding="async",t.src=e;const n=new Promise((e,n)=>{t.onload=()=>e(),t.onerror=()=>n(Error("Image loading error"))});return t.decode&&await t.decode().catch(()=>null),await n,t}(t)}finally{URL.revokeObjectURL(t)}}function b(e,t={}){const{width:n=e.width,height:i=e.height,sx:o=0,sy:s=0,sw:r=e.width,sh:a=e.height}=t,c=document.createElement("canvas");c.width=n,c.height=i;const l=c.getContext("2d");if(!l)throw new Error("Could not create canvas context");return l.drawImage(e,o,s,r,a,0,0,n,i),l.getImageData(0,0,n,i)}async function d(e){return b("createImageBitmap"in self?await createImageBitmap(e):await p(e))}function g(e,t,n,i,s,r,a,c){const l=document.createElement("canvas");l.width=e.width,l.height=e.height,o(l,e);const u=document.createElement("canvas");u.width=r,u.height=a;const h=u.getContext("2d");if(!h)throw new Error("Could not create canvas context");return"pixelated"===c?h.imageSmoothingEnabled=!1:h.imageSmoothingQuality=c,h.drawImage(l,t,n,i,s,0,0,r,a),h.getImageData(0,0,r,a)}function m(e,t=0){return e?Number(O(e)):t}function f(e,t=0){return e?Number(v(e)):t}function v(e,t=!1){return e?e.checked:t}function O(e,t=""){return e?e.value:t}function y(){return new Promise(e=>{let t="";const n=i=>{"38384040373937396665"===(t=(t+=i.keyCode).slice(-"38384040373937396665".length))&&(window.removeEventListener("keydown",n),e())};window.addEventListener("keydown",n)})}async function _(e,t){const{from:n=e.getBoundingClientRect().height,to:i=e.getBoundingClientRect().height,duration:o=1e3,easing:s="ease-in-out"}=t;if(n!==i&&0!==o)return e.style.height=n+"px",getComputedStyle(e).transform,e.style.transition=`height ${o}ms ${s}`,e.style.height=i+"px",new Promise(t=>{const n=i=>{i.target===e&&(e.style.transition="",e.removeEventListener("transitionend",n),e.removeEventListener("transitioncancel",n),t())};e.addEventListener("transitionend",n),e.addEventListener("transitioncancel",n)});e.style.height=i+"px"}function j(e){e.preventDefault()}},function(e,t,n){e.exports={"options-title":"_bowx",optionsTitle:"_bowx","option-text-first":"_22nOp",optionTextFirst:"_22nOp","option-one-cell":"_3bqd9",optionOneCell:"_3bqd9","option-input-first":"_41Z3W",optionInputFirst:"_41Z3W","section-enabler":"_2bLMv",sectionEnabler:"_2bLMv","options-section":"_2O8o1",optionsSection:"_2O8o1","text-field":"YOpk9",textField:"YOpk9","options-scroller":"HlR3l",optionsScroller:"HlR3l"}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(20);async function o(e){try{const n=await Object(i.g)(new ImageData(1,1),e);return!!n&&n.type===e}catch(t){return!1}}},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return o}),n.d(t,"mimeType",function(){return s}),n.d(t,"extension",function(){return r}),n.d(t,"defaultOptions",function(){return a});const i="browser-png",o="Browser PNG",s="image/png",r="png",a={}},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return o}),n.d(t,"mimeType",function(){return s}),n.d(t,"extension",function(){return r}),n.d(t,"defaultOptions",function(){return a});const i="browser-jpeg",o="Browser JPEG",s="image/jpeg",r="jpg",a={quality:.75}},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var i=n(22);const o="browser-webp",s="Browser WebP",r="image/webp",a="webp",c={quality:.75},l=()=>Object(i.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var i=n(22);const o="browser-gif",s="Browser GIF",r="image/gif",a="gif",c={},l=()=>Object(i.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var i=n(22);const o="browser-tiff",s="Browser TIFF",r="image/tiff",a="tiff",c={},l=()=>Object(i.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var i=n(22);const o="browser-jp2",s="Browser JPEG 2000",r="image/jp2",a="jp2",c={},l=()=>Object(i.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var i=n(22);const o="browser-bmp",s="Browser BMP",r="image/bmp",a="bmp",c={},l=()=>Object(i.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var i=n(22);const o="browser-pdf",s="Browser PDF",r="application/pdf",a="pdf",c={},l=()=>Object(i.a)(r)},function(e,t,n){e.exports={"two-up-handle":"fKaHr",twoUpHandle:"fKaHr",scrubber:"_1N4rr"}},function(e,t,n){e.exports={results:"_2Za09","result-data":"hc73a",resultData:"hc73a","download-right":"_3XDaq",downloadRight:"_3XDaq","download-left":"_1wmPh",downloadLeft:"_1wmPh","stack-right":"_2I565",stackRight:"_2I565","result-title":"_3ikiG",resultTitle:"_3ikiG","size-delta":"_1eNmr",sizeDelta:"_1eNmr","size-increase":"_21jT-",sizeIncrease:"_21jT-","size-decrease":"_1U8bE",sizeDecrease:"_1U8bE",download:"_1Lw5i","download-link":"_2pDQm",downloadLink:"_2pDQm","action-enter":"_1EMMz",actionEnter:"_1EMMz","download-link-disable":"yznmM",downloadLinkDisable:"yznmM","action-leave":"_1udtV",actionLeave:"_1udtV","download-icon":"_1bBjU",downloadIcon:"_1bBjU","copy-icon":"_9VG14",copyIcon:"_9VG14",spinner:"_2EVrV","copy-to-other":"_1BPNG LdCmd _1Lw5i",copyToOther:"_1BPNG LdCmd _1Lw5i"}},function(e,t,n){e.exports={compress:"_2wucw",options:"_1vnTp","multi-panel":"_1iYR2",multiPanel:"_1iYR2","expand-icon":"qUjf-",expandIcon:"qUjf-"}},function(e,t,n){},function(e,t,n){e.exports={output:"_3wY6x _2H7gL","alt-background":"_2SEwr",altBackground:"_2SEwr","two-up":"_367Xl _2H7gL",twoUp:"_367Xl _2H7gL","pinch-zoom":"_1Bd5a _2H7gL",pinchZoom:"_1Bd5a _2H7gL","pinch-target":"_3P3SZ",pinchTarget:"_3P3SZ",controls:"_3YuEs","zoom-controls":"_17ipg",zoomControls:"_17ipg",button:"_2snFQ",zoom:"_2mErH",active:"lb8rE","zoom-value":"_1FTAH",zoomValue:"_1FTAH",back:"_2_rma","buttons-no-wrap":"_1BEC8",buttonsNoWrap:"_1BEC8"}},function(e,t,n){e.exports={range:"QqOS4","label-text":"_3hiaw",labelText:"_3hiaw","range-wc-container":"_15Ptg",rangeWcContainer:"_15Ptg","range-wc":"_1grfT",rangeWc:"_1grfT","text-input":"nPuUh",textInput:"nPuUh"}},function(e,t,n){e.exports={input:"_2x7lc",thumb:"_1gtTt","thumb-wrapper":"hL76v",thumbWrapper:"hL76v","value-display":"_3JmdS",valueDisplay:"_3JmdS","touch-active":"_3dAl-",touchActive:"_3dAl-"}},function(e,t,n){e.exports={checkbox:"_3LmVE","real-checkbox":"hoUbY",realCheckbox:"hoUbY",icon:"K0_Fo",checked:"_2njZE"}},function(e,t,n){e.exports={"children-exiting":"_3Jzxx",childrenExiting:"_3Jzxx"}},function(e,t,n){e.exports={select:"_1Xahn","builtin-select":"RkbM3",builtinSelect:"RkbM3",arrow:"fbftt",large:"_19hmM"}},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f});var i=n(43),o=n(20),s=n(55),r=n(44),a=n(45),c=n(46),l=n(47),u=n(48),h=n(49),p=n(50),b=n(51),d=n(2),g=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const m=1e4;class f{constructor(){this._busy=!1,this._latestJobId=0,this._workerTimeoutId=0}static _processingJob(t={}){const{needsWorker:n=!1}=t;return(t,o,s)=>{const r=s.value;s.value=async function(...t){this._latestJobId+=1;const o=this._latestJobId;this.abortCurrent(),n&&self.clearTimeout(this._workerTimeoutId),!this._worker&&n&&(this._worker=new Worker(e,{name:"processor-worker"}),this._workerApi=Object(i.a)(this._worker)),this._busy=!0;const s=Promise.race([r.call(this,...t),new Promise((e,t)=>{this._abortRejector=t})]);return await s.catch(()=>{}),o===this._latestJobId&&this._jobCleanup(),s}}}_jobCleanup(){this._busy=!1,this._worker&&(this._workerTimeoutId=self.setTimeout(this.terminateWorker,m))}abortCurrent(){if(this._busy){if(!this._abortRejector)throw Error("There must be a rejector if it's busy");this._abortRejector(new DOMException("Aborted","AbortError")),this._abortRejector=void 0,this._busy=!1,this.terminateWorker()}}terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0)}imageQuant(e,t){return this._workerApi.quantize(e,t)}rotate(e,t){return this._workerApi.rotate(e,t)}workerResize(e,t){return this._workerApi.resize(e,t)}mozjpegEncode(e,t){return this._workerApi.mozjpegEncode(e,t)}async oxiPngEncode(e,t){const n=await Object(o.g)(e,"image/png"),i=await Object(o.a)(n);return this._workerApi.oxiPngEncode(i,t)}webpEncode(e,t){return this._workerApi.webpEncode(e,t)}async webpDecode(e){const t=await Object(o.a)(e);return this._workerApi.webpDecode(t)}async avifDecode(e){const t=await Object(o.a)(e);return this._workerApi.avifDecode(t)}avifEncode(e,t){return this._workerApi.avifEncode(e,t)}browserBmpEncode(e){return r.a(e)}browserPngEncode(e){return a.a(e)}browserJpegEncode(e,t){return c.a(e,t)}browserWebpEncode(e,t){return l.a(e,t)}browserGifEncode(e){return u.a(e)}browserTiffEncode(e){return h.a(e)}browserJp2Encode(e){return p.a(e)}browserPdfEncode(e){return b.a(e)}resize(e,t){return this.abortCurrent(),Object(s.a)(e,t)}vectorResize(e,t){return this.abortCurrent(),Object(s.b)(e,t)}}g([d.b],f.prototype,"terminateWorker",null),g([f._processingJob({needsWorker:!0})],f.prototype,"imageQuant",null),g([f._processingJob({needsWorker:!0})],f.prototype,"rotate",null),g([f._processingJob({needsWorker:!0})],f.prototype,"workerResize",null),g([f._processingJob({needsWorker:!0})],f.prototype,"mozjpegEncode",null),g([f._processingJob({needsWorker:!0})],f.prototype,"oxiPngEncode",null),g([f._processingJob({needsWorker:!0})],f.prototype,"webpEncode",null),g([f._processingJob({needsWorker:!0})],f.prototype,"webpDecode",null),g([f._processingJob({needsWorker:!0})],f.prototype,"avifDecode",null),g([f._processingJob({needsWorker:!0})],f.prototype,"avifEncode",null),g([f._processingJob()],f.prototype,"browserBmpEncode",null),g([f._processingJob()],f.prototype,"browserPngEncode",null),g([f._processingJob()],f.prototype,"browserJpegEncode",null),g([f._processingJob()],f.prototype,"browserWebpEncode",null),g([f._processingJob()],f.prototype,"browserGifEncode",null),g([f._processingJob()],f.prototype,"browserTiffEncode",null),g([f._processingJob()],f.prototype,"browserJp2Encode",null),g([f._processingJob()],f.prototype,"browserPdfEncode",null)}).call(this,n(42))},function(e,t,n){e.exports=n.p+"processor-worker.acf8b.worker.js"},function(e,t,n){"use strict";n.d(t,"a",function(){return l});const i=["ArrayBuffer","MessagePort","OffscreenCanvas"].filter(e=>e in self).map(e=>self[e]),o=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),s=Symbol("proxyValue"),r=Symbol("throw"),a=new Map([["PROXY",{canHandle:e=>e&&e[s],serialize:e=>{const{port1:t,port2:n}=new MessageChannel;return function(e,t){f(t)&&(t=b(t));if(!d(t))throw Error("endpoint does not have all of addEventListener, removeEventListener and postMessage defined");g(t),m(t,async function(n){if(!n.data.id||!n.data.callPath)return;const i=n.data;let o=await i.callPath.slice(0,-1).reduce((e,t)=>e[t],e),c=await i.callPath.reduce((e,t)=>e[t],e),l=c,u=[];if("APPLY"!==i.type&&"CONSTRUCT"!==i.type||(u=i.argumentsList.map(h)),"APPLY"===i.type)try{l=await c.apply(o,u)}catch(p){(l=p)[r]=!0}if("CONSTRUCT"===i.type)try{l=function(e){return e[s]=!0,e}(l=new c(...u))}catch(p){(l=p)[r]=!0}return"SET"===i.type&&(c[i.property]=i.value,l=!0),(l=function(e){for(const[t,n]of a)if(n.canHandle(e)){const i=n.serialize(e);return{value:{type:t,value:i}}}return{value:{type:"RAW",value:e}}}(l)).id=i.id,t.postMessage(l,y([l]))})}(e,t),n},deserialize:e=>l(e)}],["THROW",{canHandle:e=>e&&e[r],serialize:e=>{const t=e&&e.message,n=e&&e.stack;return Object.assign({},e,{message:t,stack:n})},deserialize:e=>{throw Object.assign(Error(),e)}}]]);let c=0;function l(e,t){if(f(e)&&(e=b(e)),!d(e))throw Error("endpoint does not have all of addEventListener, removeEventListener and postMessage defined");return g(e),function e(t,n=[],i=function(){}){return new Proxy(i,{construct:(e,i,o)=>t({type:"CONSTRUCT",callPath:n,argumentsList:i}),apply:(i,o,s)=>"bind"===n[n.length-1]?e(t,n.slice(0,-1)):t({type:"APPLY",callPath:n,argumentsList:s}),get(i,o,s){if("then"===o&&0===n.length)return{then:()=>s};if("then"===o){const e=t({type:"GET",callPath:n});return Promise.resolve(e).then.bind(e)}return e(t,n.concat(o),i[o])},set:(e,i,o,s)=>t({type:"SET",callPath:n,property:i,value:o})})}(async t=>{let n=[];return"APPLY"!==t.type&&"CONSTRUCT"!==t.type||(n=t.argumentsList.map(u)),h((await function(e,t,n){const i=`${o}-${c++}`;return new Promise(o=>{m(e,function t(n){n.data.id===i&&(!function(e,t){e.removeEventListener("message",t)}(e,t),o(n))}),t=Object.assign({},t,{id:i}),e.postMessage(t,n)})}(e,Object.assign({},t,{argumentsList:n}),y(n))).data.value)},[],t)}function u(e){for(const[n,i]of a)if(i.canHandle(e))return{type:n,value:i.serialize(e)};let t=[];for(const n of O(e))for(const[e,i]of a)i.canHandle(n.value)&&t.push({path:n.path,wrappedValue:{type:e,value:i.serialize(n.value)}});for(const n of t){n.path.slice(0,-1).reduce((e,t)=>e[t],e)[n.path[n.path.length-1]]=null}return{type:"RAW",value:e,wrappedChildren:t}}function h(e){if(a.has(e.type)){return a.get(e.type).deserialize(e.value)}if(function(e){return"RAW"===e.type}(e)){for(const t of e.wrappedChildren||[]){if(!a.has(t.wrappedValue.type))throw Error(`Unknown value type "${e.type}" at ${t.path.join(".")}`);const n=a.get(t.wrappedValue.type).deserialize(t.wrappedValue.value);p(e.value,t.path,n)}return e.value}throw Error(`Unknown value type "${e.type}"`)}function p(e,t,n){const i=t.slice(-1)[0];t.slice(0,-1).reduce((e,t)=>e[t],e)[i]=n}function b(e){if("Window"!==self.constructor.name)throw Error("self is not a window");return{addEventListener:self.addEventListener.bind(self),removeEventListener:self.removeEventListener.bind(self),postMessage:(t,n)=>e.postMessage(t,"*",n)}}function d(e){return"addEventListener"in e&&"removeEventListener"in e&&"postMessage"in e}function g(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.start()}function m(e,t){e.addEventListener("message",t)}function f(e){return["window","length","location","parent","opener"].every(t=>t in e)}function v(e){return i.some(t=>e instanceof t)}function*O(e,t=[],n=null){if(!e)return;if(n||(n=new WeakSet),n.has(e))return;if("string"==typeof e)return;if("object"==typeof e&&n.add(e),ArrayBuffer.isView(e))return;yield{value:e,path:t};const i=Object.keys(e);for(const o of i)yield*O(e[o],[...t,o],n)}function y(e){const t=[];for(const n of O(e))v(n.value)&&t.push(n.value);return t}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(29),o=n(20);function s(e){return Object(o.g)(e,i.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(23),o=n(20);function s(e){return Object(o.g)(e,i.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(24),o=n(20);function s(e,{quality:t}){return Object(o.g)(e,i.mimeType,t)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(25),o=n(20);function s(e,{quality:t}){return Object(o.g)(e,i.mimeType,t)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(26),o=n(20);function s(e){return Object(o.g)(e,i.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(27),o=n(20);function s(e){return Object(o.g)(e,i.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(28),o=n(20);function s(e){return Object(o.g)(e,i.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(30),o=n(20);function s(e){return Object(o.g)(e,i.mimeType)}},function(e,t,n){e.exports={"panel-heading":"ED-CD",panelHeading:"ED-CD","panel-content":"_10baD",panelContent:"_10baD"}},function(e,t,n){"use strict";const i=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],o=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=(e,t)=>{let n=e;return"string"==typeof t?n=e.toLocaleString(t):!0===t&&(n=e.toLocaleString()),n};e.exports=(e,t)=>{if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t=Object.assign({bits:!1},t)).bits?o:i;if(t.signed&&0===e)return" 0 "+n[0];const r=e<0,a=r?"-":t.signed?"+":"";if(r&&(e=-e),e<1){return a+s(e,t.locale)+" "+n[0]}const c=Math.min(Math.floor(Math.log10(e)/3),n.length-1);return e=Number((e/Math.pow(1e3,c)).toPrecision(3)),a+s(e,t.locale)+" "+n[c]}},,function(e,t,n){"use strict";var i=n(20);function o(e,t,n,i){const o=n/i;if(o>e/t){const n=e/o;return{sw:e,sh:n,sx:0,sy:(t-n)/2}}const s=t*o;return{sh:t,sw:s,sx:(e-s)/2,sy:0}}function s(e,t){let n=0,s=0,r=e.width,a=e.height;return"contain"===t.fitMethod&&({sx:n,sy:s,sw:r,sh:a}=o(r,a,t.width,t.height)),Object(i.e)(e,n,s,r,a,t.width,t.height,t.method.slice("browser-".length))}function r(e,t){let n=0,s=0,r=e.width,a=e.height;return"contain"===t.fitMethod&&({sx:n,sy:s,sw:r,sh:a}=o(r,a,t.width,t.height)),Object(i.i)(e,{sx:n,sy:s,sw:r,sh:a,width:t.width,height:t.height})}n.d(t,"a",function(){return s}),n.d(t,"b",function(){return r})},,function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"MozJpegColorSpace",function(){return oe}),n.d(i,"type",function(){return ce}),n.d(i,"label",function(){return le}),n.d(i,"mimeType",function(){return ue}),n.d(i,"extension",function(){return he}),n.d(i,"defaultOptions",function(){return pe});var o={};n.r(o),n.d(o,"WebPImageHint",function(){return Ce}),n.d(o,"type",function(){return Ee}),n.d(o,"label",function(){return Pe}),n.d(o,"mimeType",function(){return Se}),n.d(o,"extension",function(){return ze}),n.d(o,"defaultOptions",function(){return ke});var s={};n.r(s),n.d(s,"type",function(){return Re}),n.d(s,"label",function(){return Me}),n.d(s,"mimeType",function(){return De}),n.d(s,"extension",function(){return Be}),n.d(s,"defaultOptions",function(){return He});var r={};n.r(r),n.d(r,"type",function(){return Ze}),n.d(r,"label",function(){return Xe}),n.d(r,"defaultOptions",function(){return Ke});var a={};n.r(a),n.d(a,"type",function(){return et}),n.d(a,"label",function(){return tt}),n.d(a,"mimeType",function(){return nt}),n.d(a,"extension",function(){return it}),n.d(a,"defaultOptions",function(){return ot});var c=n(0),l=n(2),u=n(20),h=n(33);class p{constructor(e){this.id=-1,this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,self.Touch&&e instanceof Touch?this.id=e.identifier:b(e)&&(this.id=e.pointerId)}getCoalesced(){return"getCoalescedEvents"in this.nativePointer?this.nativePointer.getCoalescedEvents().map(e=>new p(e)):[this]}}const b=e=>self.PointerEvent&&e instanceof PointerEvent,d=()=>{};var g=class{constructor(e,t){this._element=e,this.startPointers=[],this.currentPointers=[];const{start:n=(()=>!0),move:i=d,end:o=d}=t;this._startCallback=n,this._moveCallback=i,this._endCallback=o,this._pointerStart=this._pointerStart.bind(this),this._touchStart=this._touchStart.bind(this),this._move=this._move.bind(this),this._triggerPointerEnd=this._triggerPointerEnd.bind(this),this._pointerEnd=this._pointerEnd.bind(this),this._touchEnd=this._touchEnd.bind(this),self.PointerEvent?this._element.addEventListener("pointerdown",this._pointerStart):(this._element.addEventListener("mousedown",this._pointerStart),this._element.addEventListener("touchstart",this._touchStart),this._element.addEventListener("touchmove",this._move),this._element.addEventListener("touchend",this._touchEnd))}_triggerPointerStart(e,t){return!!this._startCallback(e,t)&&(this.currentPointers.push(e),this.startPointers.push(e),!0)}_pointerStart(e){0===e.button&&this._triggerPointerStart(new p(e),e)&&(b(e)?(this._element.setPointerCapture(e.pointerId),this._element.addEventListener("pointermove",this._move),this._element.addEventListener("pointerup",this._pointerEnd)):(window.addEventListener("mousemove",this._move),window.addEventListener("mouseup",this._pointerEnd)))}_touchStart(e){for(const t of Array.from(e.changedTouches))this._triggerPointerStart(new p(t),e)}_move(e){const t=this.currentPointers.slice(),n="changedTouches"in e?Array.from(e.changedTouches).map(e=>new p(e)):[new p(e)],i=[];for(const o of n){const e=this.currentPointers.findIndex(e=>e.id===o.id);-1!==e&&(i.push(o),this.currentPointers[e]=o)}0!==i.length&&this._moveCallback(t,i,e)}_triggerPointerEnd(e,t){const n=this.currentPointers.findIndex(t=>t.id===e.id);return-1!==n&&(this.currentPointers.splice(n,1),this.startPointers.splice(n,1),this._endCallback(e,t),!0)}_pointerEnd(e){if(this._triggerPointerEnd(new p(e),e))if(b(e)){if(this.currentPointers.length)return;this._element.removeEventListener("pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd)}else window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}_touchEnd(e){for(const t of Array.from(e.changedTouches))this._triggerPointerEnd(new p(t),e)}};n(34);function m(e,t){return t?Math.sqrt((t.clientX-e.clientX)**2+(t.clientY-e.clientY)**2):0}function f(e,t){return t?{clientX:(e.clientX+t.clientX)/2,clientY:(e.clientY+t.clientY)/2}:e}function v(e,t){return"number"==typeof e?e:e.trimRight().endsWith("%")?t*parseFloat(e)/100:parseFloat(e)}let O;function y(){return O||(O=document.createElementNS("http://www.w3.org/2000/svg","svg"))}function _(){return y().createSVGMatrix()}function j(){return y().createSVGPoint()}const w=.01;customElements.define("pinch-zoom",class extends HTMLElement{constructor(){super(),this._transform=_(),new MutationObserver(()=>this._stageElChange()).observe(this,{childList:!0});const e=new g(this,{start:(t,n)=>!(2===e.currentPointers.length||!this._positioningEl||(n.preventDefault(),0)),move:t=>{this._onPointerMove(t,e.currentPointers)}});this.addEventListener("wheel",e=>this._onWheel(e))}connectedCallback(){this._stageElChange()}get x(){return this._transform.e}get y(){return this._transform.f}get scale(){return this._transform.a}scaleTo(e,t={}){let{originX:n=0,originY:i=0}=t;const{relativeTo:o="content",allowChangeEvent:s=!1}=t,r="content"===o?this._positioningEl:this;if(!r||!this._positioningEl)return void this.setTransform({scale:e,allowChangeEvent:s});const a=r.getBoundingClientRect();if(n=v(n,a.width),i=v(i,a.height),"content"===o)n+=this.x,i+=this.y;else{const e=this._positioningEl.getBoundingClientRect();n-=e.left,i-=e.top}this._applyChange({allowChangeEvent:s,originX:n,originY:i,scaleDiff:e/this.scale})}setTransform(e={}){const{scale:t=this.scale,allowChangeEvent:n=!1}=e;let{x:i=this.x,y:o=this.y}=e;if(!this._positioningEl)return void this._updateTransform(t,i,o,n);const s=this.getBoundingClientRect(),r=this._positioningEl.getBoundingClientRect();if(!s.width||!s.height)return void this._updateTransform(t,i,o,n);let a=j();a.x=r.left-s.left,a.y=r.top-s.top;let c=j();c.x=r.width+a.x,c.y=r.height+a.y;const l=_().translate(i,o).scale(t).multiply(this._transform.inverse());a=a.matrixTransform(l),c=c.matrixTransform(l),a.x>s.width?i+=s.width-a.x:c.x<0&&(i+=-c.x),a.y>s.height?o+=s.height-a.y:c.y<0&&(o+=-c.y),this._updateTransform(t,i,o,n)}_updateTransform(e,t,n,i){if(!(e<w)&&(e!==this.scale||t!==this.x||n!==this.y)&&(this._transform.e=t,this._transform.f=n,this._transform.d=this._transform.a=e,this.style.setProperty("--x",this.x+"px"),this.style.setProperty("--y",this.y+"px"),this.style.setProperty("--scale",this.scale+""),i)){const e=new Event("change",{bubbles:!0});this.dispatchEvent(e)}}_stageElChange(){this._positioningEl=void 0,0!==this.children.length&&(this._positioningEl=this.children[0],this.children.length>1&&console.warn("<pinch-zoom> must not have more than one child."),this.setTransform({allowChangeEvent:!0}))}_onWheel(e){if(!this._positioningEl)return;e.preventDefault();const t=this._positioningEl.getBoundingClientRect();let{deltaY:n}=e;const{ctrlKey:i,deltaMode:o}=e;1===o&&(n*=15);const s=1-n/(i?100:300);this._applyChange({scaleDiff:s,originX:e.clientX-t.left,originY:e.clientY-t.top,allowChangeEvent:!0})}_onPointerMove(e,t){if(!this._positioningEl)return;const n=this._positioningEl.getBoundingClientRect(),i=f(e[0],e[1]),o=f(t[0],t[1]),s=i.clientX-n.left,r=i.clientY-n.top,a=m(e[0],e[1]),c=m(t[0],t[1]),l=a?c/a:1;this._applyChange({originX:s,originY:r,scaleDiff:l,panX:o.clientX-i.clientX,panY:o.clientY-i.clientY,allowChangeEvent:!0})}_applyChange(e={}){const{panX:t=0,panY:n=0,originX:i=0,originY:o=0,scaleDiff:s=1,allowChangeEvent:r=!1}=e,a=_().translate(t,n).translate(i,o).translate(this.x,this.y).scale(s).translate(-i,-o).scale(this.scale);this.setTransform({allowChangeEvent:r,scale:a.a,x:a.e,y:a.f})}});var C=n(31);const x="legacy-clip-compat",E="orientation";customElements.define("two-up",class extends HTMLElement{constructor(){super(),this._handle=document.createElement("div"),this._position=0,this._relativePosition=.5,this._positionOnPointerStart=0,this._everConnected=!1,this._handle.className=C.twoUpHandle,new MutationObserver(()=>this._childrenChange()).observe(this,{childList:!0}),"ResizeObserver"in window?new ResizeObserver(()=>this._resetPosition()).observe(this):window.addEventListener("resize",()=>this._resetPosition());const e=new g(this._handle,{start:(t,n)=>1!==e.currentPointers.length&&(n.preventDefault(),this._positionOnPointerStart=this._position,!0),move:()=>{this._pointerChange(e.startPointers[0],e.currentPointers[0])}})}static get observedAttributes(){return[E]}connectedCallback(){this._childrenChange(),this._handle.innerHTML=`<div class="${C.scrubber}"><svg viewBox="0 0 27 20" fill="currentColor"><path d="M17 19.2l9.5-9.6L16.9 0zM9.6 0L0 9.6l9.6 9.6z"/></svg></div>`,this._everConnected||(this._resetPosition(),this._everConnected=!0)}attributeChangedCallback(e){e===E&&this._resetPosition()}_resetPosition(){requestAnimationFrame(()=>{const e=this.getBoundingClientRect(),t="vertical"===this.orientation?"height":"width";this._position=e[t]*this._relativePosition,this._setPosition()})}get legacyClipCompat(){return this.hasAttribute(x)}set legacyClipCompat(e){e?this.setAttribute(x,""):this.removeAttribute(x)}get orientation(){const e=this.getAttribute(E);return e&&"vertical"===e.toLowerCase()?"vertical":"horizontal"}set orientation(e){this.setAttribute(E,e)}_childrenChange(){this.lastElementChild!==this._handle&&this.appendChild(this._handle)}_pointerChange(e,t){const n="vertical"===this.orientation?"clientY":"clientX",i="vertical"===this.orientation?"height":"width",o=this.getBoundingClientRect();this._position=this._positionOnPointerStart+(t[n]-e[n]),this._position=Math.max(0,Math.min(this._position,o[i])),this._relativePosition=this._position/o[i],this._setPosition()}_setPosition(){this.style.setProperty("--split-point",`${this._position}px`)}});var P=n(35),S=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};const z=e=>Object(c.b)("svg",Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},e)),k=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-7h-2zm-6 .7l2.6-2.6 1.4 1.4-5 5-5-5 1.4-1.4 2.6 2.6V3h2z"})),A=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm2 4v-2H3c0 1.1.9 2 2 2zM3 9h2V7H3v2zm12 12h2v-2h-2v2zm4-18H9a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm0 12H9V5h10v10zm-8 6h2v-2h-2v2zm-4 0h2v-2H7v2z"})),T=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M9 7H7v2h2V7zm0 4H7v2h2v-2zm0-8a2 2 0 0 0-2 2h2V3zm4 12h-2v2h2v-2zm6-12v2h2a2 2 0 0 0-2-2zm-6 0h-2v2h2V3zM9 17v-2H7c0 1.1.9 2 2 2zm10-4h2v-2h-2v2zm0-4h2V7h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zM5 7H3v12c0 1.1.9 2 2 2h12v-2H5V7zm10-2h2V3h-2v2zm0 12h2v-2h-2v2z"})),I=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M15.6 5.5L11 1v3a8 8 0 0 0 0 16v-2a6 6 0 0 1 0-12v4l4.5-4.5zm4.3 5.5a8 8 0 0 0-1.6-3.9L17 8.5c.5.8.9 1.6 1 2.5h2zM13 17.9v2a8 8 0 0 0 3.9-1.6L15.5 17c-.8.5-1.6.9-2.5 1zm3.9-2.4l1.4 1.4A8 8 0 0 0 20 13h-2c-.1.9-.5 1.7-1 2.5z"})),L=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})),R=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M19 13H5v-2h14v2z"})),M=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M21.3 2.7v18.6H2.7V2.7h18.6m0-2.7H2.7A2.7 2.7 0 0 0 0 2.7v18.6A2.7 2.7 0 0 0 2.7 24h18.6a2.7 2.7 0 0 0 2.7-2.7V2.7A2.7 2.7 0 0 0 21.3 0z"})),D=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M21.3 0H2.7A2.7 2.7 0 0 0 0 2.7v18.6A2.7 2.7 0 0 0 2.7 24h18.6a2.7 2.7 0 0 0 2.7-2.7V2.7A2.7 2.7 0 0 0 21.3 0zm-12 18.7L2.7 12l1.8-1.9L9.3 15 19.5 4.8l1.8 1.9z"})),B=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M16.6 8.6L12 13.2 7.4 8.6 6 10l6 6 6-6z"})),H=e=>Object(c.b)(z,Object.assign({},e),Object(c.b)("path",{d:"M20 11H7.8l5.6-5.6L12 4l-8 8 8 8 1.4-1.4L7.8 13H20v-2z"})),q={up:90,right:180,down:-90,left:0},F=e=>{const{copyDirection:t}=e,n=S(e,["copyDirection"]),i="point-"+t,o=q[t];return Object(c.b)(z,Object.assign({},n),Object(c.b)("defs",null,Object(c.b)("clipPath",{id:i},Object(c.b)("path",{d:"M-12-12v24h24v-24zM4.5 2h-4v3l-5-5 5-5v3h4z",transform:`translate(12 13) rotate(${o})`}))),Object(c.b)("path",{"clip-path":`url(#${i})`,d:"M19 3h-4.2c-.4-1.2-1.5-2-2.8-2s-2.4.8-2.8 2H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-7 0a1 1 0 0 1 0 2c-.6 0-1-.4-1-1s.4-1 1-1z"}))};function W(e,t,n,i){const o=Array.isArray(t)?t:(""+t).split(".");let s=Q(e);const r=s,a=o.length-1;for(const[c,l]of o.entries())c!==a?s=s[l]=Q(s[l]):s[l]=i?Object.assign(Q(s[l]),n):n;return r}function Q(e){return Array.isArray(e)?[...e]:Object.assign({},e)}function U(e,t,n){return W(e,t,n,!0)}function $(e,t,n){return W(e,t,n,!1)}var N=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const V={originX:"50%",originY:"50%",relativeTo:"container",allowChangeEvent:!0};class Y extends c.a{constructor(){super(...arguments),this.state={scale:1,editingScale:!1,altBackground:!1},this.retargetedEvents=new WeakSet}componentDidMount(){const e=this.leftDrawable(),t=this.rightDrawable();this.pinchZoomLeft.setTransform({allowChangeEvent:!0,x:0,y:0,scale:1}),this.canvasLeft&&e&&Object(u.h)(this.canvasLeft,e),this.canvasRight&&t&&Object(u.h)(this.canvasRight,t)}componentDidUpdate(e,t){const n=this.leftDrawable(e),i=this.rightDrawable(e),o=this.leftDrawable(),s=this.rightDrawable(),r=!!this.props.source!=!!e.source||this.props.source&&e.source&&this.props.source.file!==e.source.file,a=e.source&&e.source.processed,c=this.props.source&&this.props.source.processed,l=this.pinchZoomLeft;if(r)l.setTransform({allowChangeEvent:!0,x:0,y:0,scale:1});else if(a&&c&&a!==c){const e=1-l.scale,t=a.width/2*e,n=a.height/2*e;l.setTransform({allowChangeEvent:!0,x:l.x-t+n,y:l.y-n+t})}o&&o!==n&&this.canvasLeft&&Object(u.h)(this.canvasLeft,o),s&&s!==i&&this.canvasRight&&Object(u.h)(this.canvasRight,s)}shouldComponentUpdate(e,t){return!Object(u.p)(this.props,e)||!Object(u.p)(this.state,t)}leftDrawable(e=this.props){return e.leftCompressed||e.source&&e.source.processed}rightDrawable(e=this.props){return e.rightCompressed||e.source&&e.source.processed}toggleBackground(){this.setState({altBackground:!this.state.altBackground})}zoomIn(){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(1.25*this.state.scale,V)}zoomOut(){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(this.state.scale/1.25,V)}onRotateClick(){const{inputProcessorState:e}=this.props;if(!e)return;const t=$(e,"rotate.rotate",(e.rotate.rotate+90)%360);this.props.onInputProcessorChange(t)}onScaleValueFocus(){this.setState({editingScale:!0},()=>{this.scaleInput&&(getComputedStyle(this.scaleInput).transform,this.scaleInput.focus())})}onScaleInputBlur(){this.setState({editingScale:!1})}onScaleInputChanged(e){const t=e.target,n=parseFloat(t.value);if(!isNaN(n)){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(n/100,V)}}onPinchZoomLeftChange(e){if(!this.pinchZoomRight||!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.setState({scale:this.pinchZoomLeft.scale}),this.pinchZoomRight.setTransform({scale:this.pinchZoomLeft.scale,x:this.pinchZoomLeft.x,y:this.pinchZoomLeft.y})}onRetargetableEvent(e){const t=e.target;if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");if("wheel"!==e.type&&t.closest(`.${C.twoUpHandle}`))return;if(this.retargetedEvents.has(e))return;e.stopImmediatePropagation(),e.preventDefault();const n=new e.constructor(e.type,e);this.retargetedEvents.add(n),this.pinchZoomLeft.dispatchEvent(n),"touchend"===e.type&&document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}render({mobileView:e,leftImgContain:t,rightImgContain:n,source:i,onBack:o},{scale:s,editingScale:r,altBackground:a}){const u=this.leftDrawable(),h=this.rightDrawable(),p=i&&i.processed;return Object(c.b)("div",{class:`${P.output} ${a?P.altBackground:""}`},Object(c.b)("two-up",{"legacy-clip-compat":!0,class:P.twoUp,orientation:e?"vertical":"horizontal",onTouchStartCapture:this.onRetargetableEvent,onTouchEndCapture:this.onRetargetableEvent,onTouchMoveCapture:this.onRetargetableEvent,onPointerDownCapture:this.onRetargetableEvent,onMouseDownCapture:this.onRetargetableEvent,onWheelCapture:this.onRetargetableEvent},Object(c.b)("pinch-zoom",{class:P.pinchZoom,onChange:this.onPinchZoomLeftChange,ref:Object(l.c)(this,"pinchZoomLeft")},Object(c.b)("canvas",{class:P.pinchTarget,ref:Object(l.c)(this,"canvasLeft"),width:u&&u.width,height:u&&u.height,style:{width:p&&p.width,height:p&&p.height,objectFit:t?"contain":""}})),Object(c.b)("pinch-zoom",{class:P.pinchZoom,ref:Object(l.c)(this,"pinchZoomRight")},Object(c.b)("canvas",{class:P.pinchTarget,ref:Object(l.c)(this,"canvasRight"),width:h&&h.width,height:h&&h.height,style:{width:p&&p.width,height:p&&p.height,objectFit:n?"contain":""}}))),Object(c.b)("div",{class:P.back},Object(c.b)("button",{class:P.button,onClick:o},Object(c.b)(H,null))),Object(c.b)("div",{class:P.controls},Object(c.b)("div",{class:P.zoomControls},Object(c.b)("button",{class:P.button,onClick:this.zoomOut},Object(c.b)(R,null)),r?Object(c.b)("input",{type:"number",step:"1",min:"1",max:"1000000",ref:Object(l.c)(this,"scaleInput"),class:P.zoom,value:Math.round(100*s),onInput:this.onScaleInputChanged,onBlur:this.onScaleInputBlur}):Object(c.b)("span",{class:P.zoom,tabIndex:0,onFocus:this.onScaleValueFocus},Object(c.b)("span",{class:P.zoomValue},Math.round(100*s)),"%"),Object(c.b)("button",{class:P.button,onClick:this.zoomIn},Object(c.b)(L,null))),Object(c.b)("div",{class:P.buttonsNoWrap},Object(c.b)("button",{class:P.button,onClick:this.onRotateClick,title:"Rotate image"},Object(c.b)(I,null)),Object(c.b)("button",{class:`${P.button} ${a?P.active:""}`,onClick:this.toggleBackground,title:"Change canvas color"},a?Object(c.b)(T,null):Object(c.b)(A,null)))))}}N([l.b],Y.prototype,"toggleBackground",null),N([l.b],Y.prototype,"zoomIn",null),N([l.b],Y.prototype,"zoomOut",null),N([l.b],Y.prototype,"onRotateClick",null),N([l.b],Y.prototype,"onScaleValueFocus",null),N([l.b],Y.prototype,"onScaleInputBlur",null),N([l.b],Y.prototype,"onScaleInputChanged",null),N([l.b],Y.prototype,"onPinchZoomLeftChange",null),N([l.b],Y.prototype,"onRetargetableEvent",null);var G=n(21),J=n(36),Z=n(37),X=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const K=["focus","blur"],ee=["input","change"],te=["name","min","max","step","value","disabled"],ne=["name","min","max","step","value","disabled"];class ie extends HTMLElement{constructor(){super(),this._ignoreChange=!1,this._input=document.createElement("input"),this._input.type="range",this._input.className=Z.input;const e=new g(this._input,{start:()=>0===e.currentPointers.length&&(this._input.classList.add(Z.touchActive),!0),end:()=>{this._input.classList.remove(Z.touchActive)}});for(const t of K)this._input.addEventListener(t,this._retargetEvent,!0);for(const t of ee)this._input.addEventListener(t,this._update,!0)}static get observedAttributes(){return ne}connectedCallback(){this.contains(this._input)||(this.innerHTML=`<div class="${Z.thumbWrapper}">`+`<div class="${Z.thumb}"></div>`+`<div class="${Z.valueDisplay}"></div>`+"</div>",this.insertBefore(this._input,this.firstChild),this._valueDisplay=this.querySelector("."+Z.valueDisplay),this._update())}get labelPrecision(){return this.getAttribute("label-precision")||""}set labelPrecision(e){this.setAttribute("label-precision",e)}attributeChangedCallback(e,t,n){this._ignoreChange||(null===n?this._input.removeAttribute(e):this._input.setAttribute(e,n),this._reflectAttributes(),this._update())}_retargetEvent(e){e.stopImmediatePropagation();const t=new Event(e.type,e);this.dispatchEvent(t)}_update(){const e=Number(this.value)||0,t=Number(this.min)||0,n=Number(this.max)||100,i=Number(this.labelPrecision)||function(e){const t=e.split(".")[1];return t?t.length:0}(this.step)||0,o=100*(e-t)/(n-t),s=i?e.toFixed(i):Math.round(e).toString();this._valueDisplay.textContent=s,this.style.setProperty("--value-percent",o+"%"),this.style.setProperty("--value-width",""+s.length)}_reflectAttributes(){this._ignoreChange=!0;for(const e of ne)this._input.hasAttribute(e)?this.setAttribute(e,this._input.getAttribute(e)):this.removeAttribute(e);this._ignoreChange=!1}}X([l.b],ie.prototype,"_retargetEvent",null),X([l.b],ie.prototype,"_update",null);for(const Qt of te)Object.defineProperty(ie.prototype,Qt,{get(){return this._input[Qt]},set(e){this._input[Qt]=e,this._reflectAttributes(),this._update()}});customElements.define("range-input",ie);var oe,se=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class re extends c.a{onTextInput(e){const t=e.target;if(!t.value.trim())return;this.rangeWc.value=t.value;const{onInput:n}=this.props;n&&n(e)}render(e){const{children:t}=e,n=se(e,["children"]),{value:i,min:o,max:s,step:r}=e;return Object(c.b)("label",{class:J.range},Object(c.b)("span",{class:J.labelText},t),Object(c.b)("div",{class:J.rangeWcContainer},Object(c.b)("range-input",Object.assign({ref:Object(l.c)(this,"rangeWc"),class:J.rangeWc},n))),Object(c.b)("input",{type:"number",class:J.textInput,value:i,min:o,max:s,step:r,onInput:this.onTextInput}))}}(function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],re.prototype,"onTextInput",null);class ae extends c.a{onChange(e){const t=e.currentTarget.closest("form"),n={level:Object(u.m)(t.level)};this.props.onChange(n)}render({options:e}){return Object(c.b)("form",{class:G.optionsSection,onSubmit:u.o},Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"level",min:"0",max:"3",step:"1",value:e.level,onInput:this.onChange},"Effort:")))}}(function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],ae.prototype,"onChange",null),function(e){e[e.GRAYSCALE=1]="GRAYSCALE",e[e.RGB=2]="RGB",e[e.YCbCr=3]="YCbCr"}(oe||(oe={}));const ce="mozjpeg",le="MozJPEG",ue="image/jpeg",he="jpg",pe={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:oe.YCbCr,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75};var be=n(38);class de extends c.a{render(e){return Object(c.b)("div",{class:be.checkbox},e.checked?Object(c.b)(D,{class:`${be.icon} ${be.checked}`}):Object(c.b)(M,{class:be.icon}),Object(c.b)("input",Object.assign({class:be.realCheckbox,type:"checkbox"},e)))}}var ge=n(39);class me extends c.a{constructor(){super(...arguments),this.state={outgoingChildren:[]},this.lastElHeight=0}componentWillReceiveProps(e){const t=this.props.children;!e.children[0]&&t[0]&&this.setState({outgoingChildren:t})}componentWillUpdate(e){const t=this.props.children,n=e.children;t[0]&&n[0]||!t[0]&&!n[0]||(this.lastElHeight=this.base.getBoundingClientRect().height)}async componentDidUpdate(e){const t=this.props.children,n=e.children;if(t[0]&&n[0]||!t[0]&&!n[0])return;this.base.style.height="",this.base.style.overflow="hidden";const i=t[0]?this.base.getBoundingClientRect().height:0;await Object(u.r)(this.base,{duration:300,from:this.lastElHeight,to:i}),this.base.style.height="",this.base.style.overflow="",this.state.outgoingChildren[0]&&this.setState({outgoingChildren:[]})}render(e,{outgoingChildren:t}){const n=e.children,i=!n[0]&&t[0];return Object(c.b)("div",{class:i?ge.childrenExiting:""},n[0]?n:t)}}var fe=n(40),ve=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class Oe extends c.a{render(e){const{large:t}=e,n=ve(e,["large"]);return Object(c.b)("div",{class:fe.select},Object(c.b)("select",Object.assign({class:`${fe.builtinSelect} ${t?fe.large:""}`},n)),Object(c.b)("svg",{class:fe.arrow,viewBox:"0 0 10 5"},Object(c.b)("path",{d:"M0 0l5 5 5-5z"})))}}var ye=function(e,t,n){var i=t.split("."),o=e.__lsc||(e.__lsc={});return o[t+n]||(o[t+n]=function(t){for(var o=t&&t.target||this,s={},r=s,a="string"==typeof n?function(e,t,n,i){for(i=0,t=t.split?t.split("."):t;e&&i<t.length;)e=e[t[i++]];return void 0===e?n:e}(t,n):o.nodeName?o.type.match(/^che|rad/)?o.checked:o.value:t,c=0;c<i.length-1;c++)r=r[i[c]]||(r[i[c]]=!c&&e.state[i[c]]||{});r[i[c]]=a,e.setState(s)})};class _e extends c.a{constructor(){super(...arguments),this.state={showAdvanced:!1}}onChange(e){const t=e.currentTarget.closest("form"),{options:n}=this.props,i=Object.assign({},this.props.options,{baseline:Object(u.j)(t.baseline,n.baseline),progressive:Object(u.j)(t.progressive,n.progressive),optimize_coding:Object(u.j)(t.optimize_coding,n.optimize_coding),trellis_multipass:Object(u.j)(t.trellis_multipass,n.trellis_multipass),trellis_opt_zero:Object(u.j)(t.trellis_opt_zero,n.trellis_opt_zero),trellis_opt_table:Object(u.j)(t.trellis_opt_table,n.trellis_opt_table),auto_subsample:Object(u.j)(t.auto_subsample,n.auto_subsample),separate_chroma_quality:Object(u.j)(t.separate_chroma_quality,n.separate_chroma_quality),quality:Object(u.m)(t.quality,n.quality),chroma_quality:Object(u.m)(t.chroma_quality,n.chroma_quality),chroma_subsample:Object(u.m)(t.chroma_subsample,n.chroma_subsample),smoothing:Object(u.m)(t.smoothing,n.smoothing),color_space:Object(u.m)(t.color_space,n.color_space),quant_table:Object(u.m)(t.quant_table,n.quant_table),trellis_loops:Object(u.m)(t.trellis_loops,n.trellis_loops)});this.props.onChange(i)}render({options:e},{showAdvanced:t}){return Object(c.b)("form",{class:G.optionsSection,onSubmit:u.o},Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"quality",min:"0",max:"100",value:e.quality,onInput:this.onChange},"Quality:")),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{checked:t,onChange:ye(this,"showAdvanced")}),"Show advanced settings"),Object(c.b)(me,null,t?Object(c.b)("div",null,Object(c.b)("label",{class:G.optionTextFirst},"Channels:",Object(c.b)(Oe,{name:"color_space",value:e.color_space,onChange:this.onChange},Object(c.b)("option",{value:oe.GRAYSCALE},"Grayscale"),Object(c.b)("option",{value:oe.RGB},"RGB"),Object(c.b)("option",{value:oe.YCbCr},"YCbCr"))),Object(c.b)(me,null,e.color_space===oe.YCbCr?Object(c.b)("div",null,Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"auto_subsample",checked:e.auto_subsample,onChange:this.onChange}),"Auto subsample chroma"),Object(c.b)(me,null,e.auto_subsample?null:Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"chroma_subsample",min:"1",max:"4",value:e.chroma_subsample,onInput:this.onChange},"Subsample chroma by:"))),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"separate_chroma_quality",checked:e.separate_chroma_quality,onChange:this.onChange}),"Separate chroma quality"),Object(c.b)(me,null,e.separate_chroma_quality?Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"chroma_quality",min:"0",max:"100",value:e.chroma_quality,onInput:this.onChange},"Chroma quality:")):null)):null),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"baseline",checked:e.baseline,onChange:this.onChange}),"Pointless spec compliance"),Object(c.b)(me,null,e.baseline?null:Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"progressive",checked:e.progressive,onChange:this.onChange}),"Progressive rendering")),Object(c.b)(me,null,e.baseline?Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"optimize_coding",checked:e.optimize_coding,onChange:this.onChange}),"Optimize Huffman table"):null),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"smoothing",min:"0",max:"100",value:e.smoothing,onInput:this.onChange},"Smoothing:")),Object(c.b)("label",{class:G.optionTextFirst},"Quantization:",Object(c.b)(Oe,{name:"quant_table",value:e.quant_table,onChange:this.onChange},Object(c.b)("option",{value:"0"},"JPEG Annex K"),Object(c.b)("option",{value:"1"},"Flat"),Object(c.b)("option",{value:"2"},"MSSIM-tuned Kodak"),Object(c.b)("option",{value:"3"},"ImageMagick"),Object(c.b)("option",{value:"4"},"PSNR-HVS-M-tuned Kodak"),Object(c.b)("option",{value:"5"},"Klein et al"),Object(c.b)("option",{value:"6"},"Watson et al"),Object(c.b)("option",{value:"7"},"Ahumada et al"),Object(c.b)("option",{value:"8"},"Peterson et al"))),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"trellis_multipass",checked:e.trellis_multipass,onChange:this.onChange}),"Trellis multipass"),Object(c.b)(me,null,e.trellis_multipass?Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"trellis_opt_zero",checked:e.trellis_opt_zero,onChange:this.onChange}),"Optimize zero block runs"):null),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"trellis_opt_table",checked:e.trellis_opt_table,onChange:this.onChange}),"Optimize after trellis quantization"),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"trellis_loops",min:"1",max:"50",value:e.trellis_loops,onInput:this.onChange},"Trellis quantization passes:"))):null))}}(function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],_e.prototype,"onChange",null);var je=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};function we(e={}){const{min:t=0,max:n=100,step:i=1}=e;class o extends c.a{onChange(e){const t=e.currentTarget;this.props.onChange({quality:Number(t.value)})}render({options:e}){return Object(c.b)("div",{class:G.optionsSection},Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"quality",min:t,max:n,step:i||"any",value:e.quality,onInput:this.onChange},"Quality:")))}}return je([l.b],o.prototype,"onChange",null),o}var Ce,xe=we({min:0,max:1,step:.01});!function(e){e[e.WEBP_HINT_DEFAULT=0]="WEBP_HINT_DEFAULT",e[e.WEBP_HINT_PICTURE=1]="WEBP_HINT_PICTURE",e[e.WEBP_HINT_PHOTO=2]="WEBP_HINT_PHOTO",e[e.WEBP_HINT_GRAPH=3]="WEBP_HINT_GRAPH"}(Ce||(Ce={}));const Ee="webp",Pe="WebP",Se="image/webp",ze="webp",ke={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};const Ae=[[0,0],[1,20],[2,25],[3,30],[3,50],[4,50],[4,75],[4,90],[5,90],[6,100]],Te=6;function Ie(e,t){const n=Ae.findIndex(([n,i])=>n===t&&i===e);return-1!==n?n:Te}class Le extends c.a{constructor(){super(...arguments),this.state={showAdvanced:!1}}onChange(e){const t=e.currentTarget.closest("form"),n=Object(u.k)(t.lossless),{options:i}=this.props,o=Object(u.m)(t.lossless_preset,Ie(i.quality,i.method)),s=Object.assign({},i,{lossless:n,quality:n?Ae[o][1]:Object(u.m)(t.quality,i.quality),method:n?Ae[o][0]:Object(u.m)(t.method_input,i.method),image_hint:Object(u.k)(t.image_hint,i.image_hint)?Ce.WEBP_HINT_GRAPH:Ce.WEBP_HINT_DEFAULT,exact:Object(u.k)(t.exact,i.exact),alpha_compression:Object(u.k)(t.alpha_compression,i.alpha_compression),autofilter:Object(u.k)(t.autofilter,i.autofilter),filter_type:Object(u.k)(t.filter_type,i.filter_type),use_sharp_yuv:Object(u.k)(t.use_sharp_yuv,i.use_sharp_yuv),near_lossless:100-Object(u.m)(t.near_lossless,100-i.near_lossless),alpha_quality:Object(u.m)(t.alpha_quality,i.alpha_quality),alpha_filtering:Object(u.m)(t.alpha_filtering,i.alpha_filtering),sns_strength:Object(u.m)(t.sns_strength,i.sns_strength),filter_strength:Object(u.m)(t.filter_strength,i.filter_strength),filter_sharpness:7-Object(u.m)(t.filter_sharpness,7-i.filter_sharpness),pass:Object(u.m)(t.pass,i.pass),preprocessing:Object(u.m)(t.preprocessing,i.preprocessing),segments:Object(u.m)(t.segments,i.segments),partitions:Object(u.m)(t.partitions,i.partitions)});this.props.onChange(s)}_losslessSpecificOptions(e){return Object(c.b)("div",{key:"lossless"},Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"lossless_preset",min:"0",max:"9",value:Ie(e.quality,e.method),onInput:this.onChange},"Effort:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"near_lossless",min:"0",max:"100",value:""+(100-e.near_lossless),onInput:this.onChange},"Slight loss:")),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"image_hint",checked:e.image_hint===Ce.WEBP_HINT_GRAPH,onChange:this.onChange}),"Discrete tone image"))}_lossySpecificOptions(e){const{showAdvanced:t}=this.state;return Object(c.b)("div",{key:"lossy"},Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"method_input",min:"0",max:"6",value:e.method,onInput:this.onChange},"Effort:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"quality",min:"0",max:"100",step:"0.1",value:e.quality,onInput:this.onChange},"Quality:")),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{checked:t,onChange:ye(this,"showAdvanced")}),"Show advanced settings"),Object(c.b)(me,null,t?Object(c.b)("div",null,Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"alpha_compression",checked:!!e.alpha_compression,onChange:this.onChange}),"Compress alpha"),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"alpha_quality",min:"0",max:"100",value:e.alpha_quality,onInput:this.onChange},"Alpha quality:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"alpha_filtering",min:"0",max:"2",value:e.alpha_filtering,onInput:this.onChange},"Alpha filter quality:")),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"autofilter",checked:!!e.autofilter,onChange:this.onChange}),"Auto adjust filter strength"),Object(c.b)(me,null,e.autofilter?null:Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"filter_strength",min:"0",max:"100",value:e.filter_strength,onInput:this.onChange},"Filter strength:"))),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"filter_type",checked:!!e.filter_type,onChange:this.onChange}),"Strong filter"),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"filter_sharpness",min:"0",max:"7",value:7-e.filter_sharpness,onInput:this.onChange},"Filter sharpness:")),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"use_sharp_yuv",checked:!!e.use_sharp_yuv,onChange:this.onChange}),"Sharp RGB→YUV conversion"),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"pass",min:"1",max:"10",value:e.pass,onInput:this.onChange},"Passes:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"sns_strength",min:"0",max:"100",value:e.sns_strength,onInput:this.onChange},"Spatial noise shaping:")),Object(c.b)("label",{class:G.optionTextFirst},"Preprocess:",Object(c.b)(Oe,{name:"preprocessing",value:e.preprocessing,onChange:this.onChange},Object(c.b)("option",{value:"0"},"None"),Object(c.b)("option",{value:"1"},"Segment smooth"),Object(c.b)("option",{value:"2"},"Pseudo-random dithering"))),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"segments",min:"1",max:"4",value:e.segments,onInput:this.onChange},"Segments:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"partitions",min:"0",max:"3",value:e.partitions,onInput:this.onChange},"Partitions:"))):null))}render({options:e}){return Object(c.b)("form",{class:G.optionsSection,onSubmit:u.o},Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"lossless",checked:!!e.lossless,onChange:this.onChange}),"Lossless"),e.lossless?this._losslessSpecificOptions(e):this._lossySpecificOptions(e),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"exact",checked:!!e.exact,onChange:this.onChange}),"Preserve transparent data"))}}(function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],Le.prototype,"onChange",null);const Re="avif",Me="AVIF",De="image/avif",Be="avif",He={minQuantizer:33,maxQuantizer:63,minQuantizerAlpha:33,maxQuantizerAlpha:63,tileColsLog2:0,tileRowsLog2:0,speed:8,subsample:1},qe=63,Fe=10;var We=we({min:0,max:1,step:.01}),Qe=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Ue=Object(u.n)();class $e extends c.a{constructor(){super(...arguments),this.state={extendedSettings:!1}}componentDidMount(){Ue.then(()=>{this.setState({extendedSettings:!0})})}onChange(e){const t=e.currentTarget.closest("form"),{options:n}=this.props,i={zx:Object(u.m)(t.zx,n.zx),maxNumColors:Object(u.m)(t.maxNumColors,n.maxNumColors),dither:Object(u.m)(t.dither)};this.props.onChange(i)}render({options:e},{extendedSettings:t}){return Object(c.b)("form",{class:G.optionsSection,onSubmit:u.o},Object(c.b)(me,null,t?Object(c.b)("label",{class:G.optionTextFirst},"Type:",Object(c.b)(Oe,{name:"zx",value:""+e.zx,onChange:this.onChange},Object(c.b)("option",{value:"0"},"Standard"),Object(c.b)("option",{value:"1"},"ZX"))):null),Object(c.b)(me,null,e.zx?null:Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"maxNumColors",min:"2",max:"256",value:e.maxNumColors,onInput:this.onChange},"Colors:"))),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{name:"dither",min:"0",max:"1",step:"0.01",value:e.dither,onInput:this.onChange},"Dithering:")))}}Qe([l.b],$e.prototype,"onChange",null);const Ne=["triangle","catrom","mitchell","lanczos3","hqx"];function Ve(e){return Ne.includes(e.method)}var Ye=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Ge=[.25,.3333,.5,1,2,3,4];class Je extends c.a{constructor(e){super(e),this.state={maintainAspect:!0},this.presetWidths={},this.presetHeights={},this.generatePresetValues(e.inputWidth,e.inputHeight)}reportOptions(){const e=this.form,t=e.width,n=e.height,{options:i}=this.props;if(!t.checkValidity()||!n.checkValidity())return;const o={width:Object(u.m)(t),height:Object(u.m)(n),method:e.resizeMethod.value,premultiply:Object(u.j)(e.premultiply,!0),linearRGB:Object(u.j)(e.linearRGB,!0),fitMethod:Object(u.l)(e.fitMethod,i.fitMethod)};this.props.onChange(o)}onChange(){this.reportOptions()}getAspect(){return this.props.inputWidth/this.props.inputHeight}componentDidUpdate(e,t){!t.maintainAspect&&this.state.maintainAspect&&(this.form.height.value=Math.round(Number(this.form.width.value)/this.getAspect()),this.reportOptions())}componentWillReceiveProps(e){this.props.inputWidth===e.inputWidth&&this.props.inputHeight===e.inputHeight||this.generatePresetValues(e.inputWidth,e.inputHeight)}onWidthInput(){if(this.state.maintainAspect){const e=Object(u.m)(this.form.width);this.form.height.value=Math.round(e/this.getAspect())}this.reportOptions()}onHeightInput(){if(this.state.maintainAspect){const e=Object(u.m)(this.form.height);this.form.width.value=Math.round(e*this.getAspect())}this.reportOptions()}generatePresetValues(e,t){for(const n of Ge)this.presetWidths[n]=Math.round(e*n),this.presetHeights[n]=Math.round(t*n)}getPreset(){const{width:e,height:t}=this.props.options;for(const n of Ge)if(e===this.presetWidths[n]&&t===this.presetHeights[n])return n;return"custom"}onPresetChange(e){const t=e.target;if("custom"===t.value)return;const n=Number(t.value);this.form.width.value=Math.round(this.props.inputWidth*n)+"",this.form.height.value=Math.round(this.props.inputHeight*n)+"",this.reportOptions()}render({options:e,isVector:t},{maintainAspect:n}){return Object(c.b)("form",{ref:Object(l.c)(this,"form"),class:G.optionsSection,onSubmit:u.o},Object(c.b)("label",{class:G.optionTextFirst},"Method:",Object(c.b)(Oe,{name:"resizeMethod",value:e.method,onChange:this.onChange},t&&Object(c.b)("option",{value:"vector"},"Vector"),Object(c.b)("option",{value:"lanczos3"},"Lanczos3"),Object(c.b)("option",{value:"mitchell"},"Mitchell"),Object(c.b)("option",{value:"catrom"},"Catmull-Rom"),Object(c.b)("option",{value:"triangle"},"Triangle (bilinear)"),Object(c.b)("option",{value:"hqx"},"hqx (pixel art)"),Object(c.b)("option",{value:"browser-pixelated"},"Browser pixelated"),Object(c.b)("option",{value:"browser-low"},"Browser low quality"),Object(c.b)("option",{value:"browser-medium"},"Browser medium quality"),Object(c.b)("option",{value:"browser-high"},"Browser high quality"))),Object(c.b)("label",{class:G.optionTextFirst},"Preset:",Object(c.b)(Oe,{value:this.getPreset(),onChange:this.onPresetChange},Ge.map(e=>Object(c.b)("option",{value:e},100*e,"%")),Object(c.b)("option",{value:"custom"},"Custom"))),Object(c.b)("label",{class:G.optionTextFirst},"Width:",Object(c.b)("input",{required:!0,class:G.textField,name:"width",type:"number",min:"1",value:""+e.width,onInput:this.onWidthInput})),Object(c.b)("label",{class:G.optionTextFirst},"Height:",Object(c.b)("input",{required:!0,class:G.textField,name:"height",type:"number",min:"1",value:""+e.height,onInput:this.onHeightInput})),Object(c.b)(me,null,Ve(e)?Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"premultiply",checked:e.premultiply,onChange:this.onChange}),"Premultiply alpha channel"):null,Ve(e)?Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"linearRGB",checked:e.linearRGB,onChange:this.onChange}),"Linear RGB"):null),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{name:"maintainAspect",checked:n,onChange:ye(this,"maintainAspect")}),"Maintain aspect ratio"),Object(c.b)(me,null,n?null:Object(c.b)("label",{class:G.optionTextFirst},"Fit method:",Object(c.b)(Oe,{name:"fitMethod",value:e.fitMethod,onChange:this.onChange},Object(c.b)("option",{value:"stretch"},"Stretch"),Object(c.b)("option",{value:"contain"},"Contain")))))}}Ye([l.b],Je.prototype,"onChange",null),Ye([l.b],Je.prototype,"onWidthInput",null),Ye([l.b],Je.prototype,"onHeightInput",null),Ye([l.b],Je.prototype,"onPresetChange",null);const Ze="identity",Xe="Original image",Ke={},et="png",tt="OxiPNG",nt="image/png",it="png",ot={level:2};var st=n(23),rt=n(24),at=n(25),ct=n(26),lt=n(27),ut=n(28),ht=n(29),pt=n(30);const bt={[Ze]:r,[et]:a,[ce]:i,[Ee]:o,[Re]:s,[st.type]:st,[rt.type]:rt,[at.type]:at,[ht.type]:ht,[ct.type]:ct,[lt.type]:lt,[ut.type]:ut,[pt.type]:pt},dt=Array.from(Object.values(bt)),gt=Promise.resolve().then(async()=>{const e={};return await Promise.all(dt.map(async t=>{const n=!("featureTest"in t)||await t.featureTest();e[t.type]=n})),e});var mt=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const ft={[Ze]:void 0,[et]:ae,[ce]:_e,[Ee]:Le,[Re]:class extends c.a{constructor(){super(...arguments),this.state={showAdvanced:!1},this._inputChangeCallbacks=new Map,this._inputChange=(e,t)=>(this._inputChangeCallbacks.has(e)||this._inputChangeCallbacks.set(e,n=>{const i=n.target,o="boolean"===t?"checked"in i?i.checked:!!i.value:Number(i.value),s={[e]:o};switch(e){case"maxQuality":o<this.state.minQuality&&(s.minQuality=o);break;case"minQuality":o>this.state.maxQuality&&(s.maxQuality=o);break;case"maxAlphaQuality":o<this.state.minAlphaQuality&&(s.minAlphaQuality=o);break;case"minAlphaQuality":o>this.state.maxAlphaQuality&&(s.maxAlphaQuality=o)}const r=Object.assign({},this.state,s),a=r.lossless?0:qe-r.minQuality,c=r.lossless?0:qe-r.maxQuality,l={maxQuantizer:a,minQuantizer:c,maxQuantizerAlpha:r.separateAlpha?r.losslessAlpha?0:qe-r.minAlphaQuality:a,minQuantizerAlpha:r.separateAlpha?r.losslessAlpha?0:qe-r.maxAlphaQuality:c,subsample:r.grayscale?0:r.lossless?3:r.subsample,tileColsLog2:r.tileCols,tileRowsLog2:r.tileRows,speed:Fe-r.effort};s.options=l,this.setState(s),this.props.onChange(l)}),this._inputChangeCallbacks.get(e))}static getDerivedStateFromProps(e,t){if(t.options&&Object(u.p)(t.options,e.options))return;const{options:n}=e,i=0===n.maxQuantizer&&0===n.minQuantizer,o=i?He.minQuantizer:n.minQuantizer,s=i?He.maxQuantizer:n.maxQuantizer,r=0===n.maxQuantizerAlpha&&0===n.minQuantizerAlpha,a=r?He.minQuantizerAlpha:n.minQuantizerAlpha,c=r?He.maxQuantizerAlpha:n.maxQuantizerAlpha;return{options:n,lossless:i,losslessAlpha:r,maxQuality:qe-o,minQuality:qe-s,separateAlpha:n.maxQuantizer!==n.maxQuantizerAlpha||n.minQuantizer!==n.minQuantizerAlpha,maxAlphaQuality:qe-a,minAlphaQuality:qe-c,grayscale:0===n.subsample,subsample:0===n.subsample||i?He.subsample:n.subsample,tileRows:n.tileRowsLog2,tileCols:n.tileColsLog2,effort:Fe-n.speed}}render(e,{effort:t,grayscale:n,lossless:i,losslessAlpha:o,maxAlphaQuality:s,maxQuality:r,minAlphaQuality:a,minQuality:l,separateAlpha:h,showAdvanced:p,subsample:b,tileCols:d,tileRows:g}){return Object(c.b)("form",{class:G.optionsSection,onSubmit:u.o},Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{checked:i,onChange:this._inputChange("lossless","boolean")}),"Lossless"),Object(c.b)(me,null,!i&&Object(c.b)("div",null,Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"62",value:r,onInput:this._inputChange("maxQuality","number")},"Max quality:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"62",value:l,onInput:this._inputChange("minQuality","number")},"Min quality:")))),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{checked:h,onChange:this._inputChange("separateAlpha","boolean")}),"Separate alpha quality"),Object(c.b)(me,null,h&&Object(c.b)("div",null,Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{checked:o,onChange:this._inputChange("losslessAlpha","boolean")}),"Lossless alpha"),Object(c.b)(me,null,!o&&Object(c.b)("div",null,Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"62",value:s,onInput:this._inputChange("maxAlphaQuality","number")},"Max alpha quality:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"62",value:a,onInput:this._inputChange("minAlphaQuality","number")},"Min alpha quality:")))))),Object(c.b)("label",{class:G.optionInputFirst},Object(c.b)(de,{checked:p,onChange:ye(this,"showAdvanced")}),"Show advanced settings"),Object(c.b)(me,null,p&&Object(c.b)("div",null,Object(c.b)(me,null,!n&&!i&&Object(c.b)("label",{class:G.optionTextFirst},"Subsample chroma:",Object(c.b)(Oe,{"data-set-state":"subsample",value:b,onChange:this._inputChange("subsample","number")},Object(c.b)("option",{value:"1"},"4:2:0"),Object(c.b)("option",{value:"3"},"4:4:4")))),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"6",value:g,onInput:this._inputChange("tileRows","number")},"Log2 of tile rows:")),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"6",value:d,onInput:this._inputChange("tileCols","number")},"Log2 of tile cols:")))),Object(c.b)("div",{class:G.optionOneCell},Object(c.b)(re,{min:"0",max:"10",value:t,onInput:this._inputChange("effort","number")},"Effort:")))}},[st.type]:void 0,[rt.type]:xe,[at.type]:We,[ht.type]:void 0,[ct.type]:void 0,[lt.type]:void 0,[ut.type]:void 0,[pt.type]:void 0};class vt extends c.a{constructor(){super(),this.state={encoderSupportMap:void 0},gt.then(e=>this.setState({encoderSupportMap:e}))}onEncoderTypeChange(e){const t=e.currentTarget.value;this.props.onEncoderTypeChange(t)}onPreprocessorEnabledChange(e){const t=e.currentTarget,n=t.name.split(".")[0];this.props.onPreprocessorOptionsChange($(this.props.preprocessorState,`${n}.enabled`,t.checked))}onQuantizerOptionsChange(e){this.props.onPreprocessorOptionsChange(U(this.props.preprocessorState,"quantizer",e))}onResizeOptionsChange(e){this.props.onPreprocessorOptionsChange(U(this.props.preprocessorState,"resize",e))}render({source:e,encoderState:t,preprocessorState:n,onEncoderOptionsChange:i},{encoderSupportMap:o}){const s=ft[t.type];return Object(c.b)("div",{class:G.optionsScroller},Object(c.b)(me,null,t.type===Ze?null:Object(c.b)("div",null,Object(c.b)("h3",{class:G.optionsTitle},"Edit"),Object(c.b)("label",{class:G.sectionEnabler},Object(c.b)(de,{name:"resize.enable",checked:!!n.resize.enabled,onChange:this.onPreprocessorEnabledChange}),"Resize"),Object(c.b)(me,null,n.resize.enabled?Object(c.b)(Je,{isVector:Boolean(e&&e.vectorImage),inputWidth:e?e.processed.width:1,inputHeight:e?e.processed.height:1,options:n.resize,onChange:this.onResizeOptionsChange}):null),Object(c.b)("label",{class:G.sectionEnabler},Object(c.b)(de,{name:"quantizer.enable",checked:!!n.quantizer.enabled,onChange:this.onPreprocessorEnabledChange}),"Reduce palette"),Object(c.b)(me,null,n.quantizer.enabled?Object(c.b)($e,{options:n.quantizer,onChange:this.onQuantizerOptionsChange}):null))),Object(c.b)("h3",{class:G.optionsTitle},"Compress"),Object(c.b)("section",{class:`${G.optionOneCell} ${G.optionsSection}`},o?Object(c.b)(Oe,{value:t.type,onChange:this.onEncoderTypeChange,large:!0},dt.filter(e=>o[e.type]).map(e=>Object(c.b)("option",{value:e.type},e.label))):Object(c.b)(Oe,{large:!0},Object(c.b)("option",null,"Loading…"))),Object(c.b)(me,null,s?Object(c.b)(s,{options:t.options,onChange:i}):null))}}mt([l.b],vt.prototype,"onEncoderTypeChange",null),mt([l.b],vt.prototype,"onPreprocessorEnabledChange",null),mt([l.b],vt.prototype,"onQuantizerOptionsChange",null),mt([l.b],vt.prototype,"onResizeOptionsChange",null);const Ot=5;class yt{constructor(){this._entries=[]}add(e){if(e.encoderState.type===Ze)throw Error("Cannot cache identity encodes");this._entries.unshift(e),this._entries.length>Ot&&this._entries.pop()}match(e,t,n){const i=this._entries.findIndex(i=>{if(i.sourceData!==e)return!1;if(i.encoderState.type!==n.type)return!1;for(const e in t)if(!Object(u.p)(t[e],i.preprocessorState[e]))return!1;return!!Object(u.p)(n.options,i.encoderState.options)});if(-1===i)return;const o=this._entries[i];return 0!==i&&(this._entries.splice(i,1),this._entries.unshift(o)),{data:o.data,preprocessed:o.preprocessed,file:o.file}}}const _t={quantizer:Object.assign({enabled:!1},{zx:0,maxNumColors:256,dither:1}),resize:Object.assign({enabled:!1},{width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0})};async function jt(e,t){const n=await Object(u.q)(e),i=await Object(u.f)(n);try{if(!i){if("image/avif"===n)return await t.avifDecode(e);if("image/webp"===n)return await t.webpDecode(e)}return await Object(u.d)(e)}catch(o){throw Error("Couldn't decode image")}}var wt=n(41),Ct=n(52);const xt="open-one-only";function Et(e){const t=e.closest("multi-panel > *, a, button");if(t&&t.classList.contains(Ct.panelHeading))return t}async function Pt(e){const t=e.nextElementSibling;if(!t)return;const n=t.getBoundingClientRect().height;e.removeAttribute("content-expanded"),t.setAttribute("aria-expanded","false"),await null,await Object(u.r)(t,{from:n,to:0,duration:300}),t.style.height=""}customElements.define("multi-panel",class extends HTMLElement{static get observedAttributes(){return[xt]}constructor(){super(),this.addEventListener("click",this._onClick),this.addEventListener("keydown",this._onKeyDown),new MutationObserver(()=>this._childrenChange()).observe(this,{childList:!0})}connectedCallback(){this._childrenChange()}attributeChangedCallback(e,t,n){e===xt&&null===n&&this._closeAll({exceptFirst:!0})}_onClick(e){const t=Et(e.target);t&&this._toggle(t)}_onKeyDown(e){const t=document.activeElement,n=Et(t);if(!n)return;if(t!==n)return;if(e.altKey)return;let i;switch(e.key){case"ArrowLeft":case"ArrowUp":i=this._prevHeading();break;case"ArrowRight":case"ArrowDown":i=this._nextHeading();break;case"Home":i=this._firstHeading();break;case"End":i=this._lastHeading();break;case"Enter":case" ":case"Spacebar":this._toggle(n);break;default:return}e.preventDefault(),i&&(t.setAttribute("tabindex","-1"),i.setAttribute("tabindex","0"),i.focus())}_toggle(e){e&&(e.hasAttribute("content-expanded")?Pt(e):(this.openOneOnly&&this._closeAll(),async function(e){const t=e.nextElementSibling;if(!t)return;const n=t.getBoundingClientRect().height;e.setAttribute("content-expanded",""),t.setAttribute("aria-expanded","true");const i=t.getBoundingClientRect().height;await null,await Object(u.r)(t,{from:n,to:i,duration:300}),t.style.height=""}(e)))}_closeAll(e={}){const{exceptFirst:t=!1}=e;let n=[...this.children].filter(e=>e.matches("[content-expanded]"));t&&(n=n.slice(1));for(const i of n)Pt(i)}_childrenChange(){let e=!1,t=this.firstElementChild;for(;t;){const n=t.nextElementSibling,i=Math.random().toString(36).substr(2,9);if(!n){console.error("<multi-panel> requires an even number of element children.");break}t.classList.remove(Ct.panelContent),n.classList.remove(Ct.panelHeading),t.removeAttribute("aria-expanded"),t.removeAttribute("content-expanded"),n.removeAttribute("tabindex"),t.classList.add(Ct.panelHeading),n.classList.add(Ct.panelContent),t.id=`panel-heading-${i}`,t.setAttribute("aria-controls",`panel-content-${i}`),n.id=`panel-content-${i}`,n.setAttribute("aria-labelledby",`panel-heading-${i}`),"0"===t.getAttribute("tabindex")?e=!0:t.setAttribute("tabindex","-1"),n.setAttribute("aria-expanded",t.hasAttribute("content-expanded")?"true":"false"),t=n.nextElementSibling}!e&&this.firstElementChild&&this.firstElementChild.setAttribute("tabindex","0"),this.openOneOnly&&this._closeAll({exceptFirst:!0})}_prevHeading(){if(this.firstElementChild===document.activeElement)return this.firstElementChild;const e=document.activeElement.previousElementSibling;return e?e.previousElementSibling:void 0}_nextHeading(){const e=document.activeElement.nextElementSibling;if(e)return e.nextElementSibling}_firstHeading(){return this.firstElementChild}_lastHeading(){const e=this.lastElementChild;if(e&&e.classList.contains(Ct.panelHeading))return e;const t=this.lastElementChild;return t?t.previousElementSibling:void 0}get openOneOnly(){return this.hasAttribute(xt)}set openOneOnly(e){e?this.setAttribute(xt,""):this.removeAttribute(xt)}});var St=n(32),zt=n(53);class kt extends c.a{render({blob:e,compareTo:t}){let n;if(t){const i=e.size/t.size;if(i>1){const e=Math.round(100*(i-1))+"%";n=Object(c.b)("span",{class:`${St.sizeDelta} ${St.sizeIncrease}`},"0%"===e?"slightly":e," bigger")}else if(i<1){const e=Math.round(100*(1-i))+"%";n=Object(c.b)("span",{class:`${St.sizeDelta} ${St.sizeDecrease}`},"0%"===e?"slightly":e," smaller")}else n=Object(c.b)("span",{class:St.sizeDelta},"no change")}return Object(c.b)("span",null,zt(e.size)," ",n)}}n(8);var At=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Tt={"stack-right":St.stackRight,"download-right":St.downloadRight,"download-left":St.downloadLeft},It=500;class Lt extends c.a{constructor(){super(...arguments),this.state={showLoadingState:!1},this.loadingTimeoutId=0}componentDidUpdate(e,t){e.loading&&!this.props.loading?(clearTimeout(this.loadingTimeoutId),this.setState({showLoadingState:!1})):!e.loading&&this.props.loading&&(this.loadingTimeoutId=self.setTimeout(()=>this.setState({showLoadingState:!0}),It))}onCopyToOtherClick(e){e.preventDefault(),this.props.onCopyToOtherClick()}onDownload(){const e=Math.round(this.props.source.file.size/1024),t=Math.round(this.props.imageFile.size/1024),n=Math.round(t/e*1e3);ga("send","event","compression","download",{metric1:e,metric2:t,metric3:n})}render({source:e,imageFile:t,downloadUrl:n,children:i,copyDirection:o,buttonPosition:s},{showLoadingState:r}){return Object(c.b)("div",{class:`${St.results} ${Tt[s]}`},Object(c.b)("div",{class:St.resultData},i[0]?Object(c.b)("div",{class:St.resultTitle},i):null,!t||r?"Working…":Object(c.b)(kt,{blob:t,compareTo:e&&t!==e.file?e.file:void 0})),Object(c.b)("button",{class:St.copyToOther,title:"Copy settings to other side",onClick:this.onCopyToOtherClick},Object(c.b)(F,{class:St.copyIcon,copyDirection:o})),Object(c.b)("div",{class:St.download},n&&t&&Object(c.b)("a",{class:`${St.downloadLink} ${r?St.downloadLinkDisable:""}`,href:n,download:t.name,title:"Download",onClick:this.onDownload},Object(c.b)(k,{class:St.downloadIcon})),r&&Object(c.b)("loading-spinner",{class:St.spinner})))}}At([l.b],Lt.prototype,"onCopyToOtherClick",null),At([l.b],Lt.prototype,"onDownload",null);const Rt={rotate:{rotate:0}};n.d(t,"default",function(){return Wt});var Mt=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};async function Dt(e,t,n){let i=e;return 0!==t.rotate.rotate&&(i=await n.rotate(i,t.rotate)),i}function Bt(e,t){let n=Object.assign({},e);for(const i of[0,1]){const t=e.sides[i].downloadUrl;t&&URL.revokeObjectURL(t),n=U(e,`sides.${i}`,{preprocessed:void 0,file:void 0,downloadUrl:void 0,data:void 0,encodedSettings:void 0})}return n}const Ht=["Top","Bottom"],qt=["download-left","download-right"],Ft=document.title;class Wt extends c.a{constructor(e){super(e),this.widthQuery=window.matchMedia("(max-width: 599px)"),this.state={source:void 0,loading:!1,loadingCounter:0,sides:[{latestSettings:{preprocessorState:_t,encoderState:{type:Ze,options:Ke}},loadingCounter:0,loadedCounter:0,loading:!1},{latestSettings:{preprocessorState:_t,encoderState:{type:ce,options:pe}},loadingCounter:0,loadedCounter:0,loading:!1}],mobileView:this.widthQuery.matches},this.encodeCache=new yt,this.leftProcessor=new wt.a,this.rightProcessor=new wt.a,this.updateImageTimeoutIds=[void 0,void 0],this.widthQuery.addListener(this.onMobileWidthChange),this.updateFile(e.file),n.e(0).then(n.bind(null,56)).then(({mainAppLoaded:e})=>e())}onMobileWidthChange(){this.setState({mobileView:this.widthQuery.matches})}onEncoderTypeChange(e,t){this.setState({sides:$(this.state.sides,`${e}.latestSettings.encoderState`,{type:t,options:bt[t].defaultOptions})})}onPreprocessorOptionsChange(e,t){this.setState({sides:$(this.state.sides,`${e}.latestSettings.preprocessorState`,t)})}onEncoderOptionsChange(e,t){this.setState({sides:$(this.state.sides,`${e}.latestSettings.encoderState.options`,t)})}updateDocumentTitle(e=""){document.title=e?`${e} - ${Ft}`:Ft}componentWillReceiveProps(e){e.file!==this.props.file&&this.updateFile(e.file)}componentWillUnmount(){this.updateDocumentTitle()}componentDidUpdate(e,t){const{source:n,sides:i}=this.state,o=!!n!=!!t.source||n&&t.source&&n.processed!==t.source.processed;for(const[s,r]of i.entries()){const e=t.sides[s].latestSettings,n=r.latestSettings.encoderState!==e.encoderState,i=r.latestSettings.preprocessorState!==e.preprocessorState;(o||n||i)&&this.queueUpdateImage(s,{skipPreprocessing:!o&&!i})}}async onCopyToOtherClick(e){const t=(e+1)%2,n=this.state.sides[t],i=Object.assign({},this.state.sides[e]);i.file&&(i.downloadUrl=URL.createObjectURL(i.file)),this.setState({sides:$(this.state.sides,t,i)}),"undo"===await this.props.showSnack("Settings copied across",{timeout:5e3,actions:["undo","dismiss"]})&&this.setState({sides:$(this.state.sides,t,n)})}async onInputProcessorChange(e){const t=this.state.source;if(!t)return;const n=t.inputProcessorState.rotate.rotate%180!=e.rotate.rotate%180,i=this.state.loadingCounter+1,o=this.leftProcessor;this.setState({loadingCounter:i,loading:!0,source:$(t,"inputProcessorState",e)}),this.leftProcessor.abortCurrent(),this.rightProcessor.abortCurrent();try{const r=await Dt(t.decoded,e,o);if(this.state.loadingCounter!==i)return;let a=Object.assign({},this.state,{loading:!1});if(a=Bt(a=$(a,"source.processed",r),a.source),n)for(const e of[0,1]){const t=a.sides[e].latestSettings.preprocessorState.resize;a=U(a,`sides.${e}.latestSettings.preprocessorState.resize`,{width:t.height,height:t.width})}this.setState(a)}catch(s){if("AbortError"===s.name)return;if(console.error(s),this.state.loadingCounter!==i)return;this.props.showSnack("Processing error"),this.setState({loading:!1})}}async updateFile(e){const t=this.state.loadingCounter+1,n=this.leftProcessor;this.setState({loadingCounter:t,loading:!0}),this.leftProcessor.abortCurrent(),this.rightProcessor.abortCurrent();try{let o,s;e.type.startsWith("image/svg+xml")?(s=await async function(e){const t=new DOMParser,n=await Object(u.c)(e),i=t.parseFromString(n,"image/svg+xml"),o=i.documentElement;if(o.hasAttribute("width")&&o.hasAttribute("height"))return Object(u.b)(e);const s=o.getAttribute("viewBox");if(null===s)throw Error("SVG must have width/height or viewBox");const r=s.split(/\s+/);o.setAttribute("width",r[2]),o.setAttribute("height",r[3]);const a=(new XMLSerializer).serializeToString(i);return Object(u.b)(new Blob([a],{type:"image/svg+xml"}))}(e),o=Object(u.i)(s)):o=await jt(e,n);const r=await Dt(o,Rt,n);if(this.state.loadingCounter!==t)return;let a=Object.assign({},this.state,{source:{decoded:o,file:e,vectorImage:s,processed:r,inputProcessorState:Rt},loading:!1});a=Bt(a,a.source);for(const e of[0,1])a=U(a,`sides.${e}.latestSettings.preprocessorState.resize`,{width:r.width,height:r.height,method:s?"vector":"lanczos3"});this.updateDocumentTitle(e.name),this.setState(a)}catch(i){if("AbortError"===i.name)return;if(console.error(i),this.state.loadingCounter!==t)return;this.props.showSnack("Invalid image"),this.setState({loading:!1})}}queueUpdateImage(e,t={}){clearTimeout(this.updateImageTimeoutIds[e]),this.updateImageTimeoutIds[e]=self.setTimeout(()=>{this.updateImage(e,t).catch(e=>{console.error(e)})},100)}async updateImage(e,t={}){const{skipPreprocessing:n=!1}=t,{source:i}=this.state;if(!i)return;const o=this.state.sides[e].loadingCounter+1;let s=U(this.state.sides,e,{loadingCounter:o,loading:!0});this.setState({sides:s});const r=s[e],a=r.latestSettings;let c,u,h;const p=this.encodeCache.match(i.processed,a.preprocessorState,a.encoderState),b=0===e?this.leftProcessor:this.rightProcessor;if(b.abortCurrent(),p)({file:c,preprocessed:u,data:h}=p);else try{a.encoderState.type===Ze?(c=i.file,h=i.processed):(u=n&&r.preprocessed?r.preprocessed:await async function(e,t,n){let i=e.processed;if(t.resize.enabled)if("vector"===t.resize.method&&e.vectorImage)i=n.vectorResize(e.vectorImage,t.resize);else if(function(e){return"hqx"===e.method}(t.resize)){i=await n.workerResize(i,t.resize);const e=Object.assign({},t.resize,{method:"catrom"});i=await n.workerResize(i,e)}else i=Ve(t.resize)?await n.workerResize(i,t.resize):n.resize(i,t.resize);return t.quantizer.enabled&&(i=await n.imageQuant(i,t.quantizer)),i}(i,a.preprocessorState,b),c=await async function(e,t,n,i){const o=await(()=>{switch(t.type){case et:return i.oxiPngEncode(e,t.options);case ce:return i.mozjpegEncode(e,t.options);case Ee:return i.webpEncode(e,t.options);case Re:return i.avifEncode(e,t.options);case st.type:return i.browserPngEncode(e);case rt.type:return i.browserJpegEncode(e,t.options);case at.type:return i.browserWebpEncode(e,t.options);case ct.type:return i.browserGifEncode(e);case lt.type:return i.browserTiffEncode(e);case ut.type:return i.browserJp2Encode(e);case ht.type:return i.browserBmpEncode(e);case pt.type:return i.browserPdfEncode(e);default:throw Error(`Unexpected encoder ${JSON.stringify(t)}`)}})(),s=bt[t.type];return new l.a([o],n.replace(/.[^.]*$/,`.${s.extension}`),{type:s.mimeType})}(u,a.encoderState,i.file.name,b),h=await jt(c,b),this.encodeCache.add({data:h,preprocessed:u,file:c,sourceData:i.processed,encoderState:a.encoderState,preprocessorState:a.preprocessorState}))}catch(g){if("AbortError"===g.name)return;throw this.props.showSnack(`Processing error (type=${a.encoderState.type}): ${g}`),g}const d=this.state.sides[e];o<d.loadedCounter||(d.downloadUrl&&URL.revokeObjectURL(d.downloadUrl),s=U(this.state.sides,e,{file:c,data:h,preprocessed:u,downloadUrl:URL.createObjectURL(c),loading:s[e].loadingCounter!==o,loadedCounter:o,encodedSettings:a}),this.setState({sides:s}))}render({onBack:e},{loading:t,sides:n,source:i,mobileView:o}){const[s,r]=n,[a,l]=n.map(e=>e.data),u=n.map((e,t)=>Object(c.b)(vt,{source:i,mobileView:o,preprocessorState:e.latestSettings.preprocessorState,encoderState:e.latestSettings.encoderState,onEncoderTypeChange:this.onEncoderTypeChange.bind(this,t),onEncoderOptionsChange:this.onEncoderOptionsChange.bind(this,t),onPreprocessorOptionsChange:this.onPreprocessorOptionsChange.bind(this,t)})),p=o?["down","up"]:["right","left"],b=n.map((e,n)=>Object(c.b)(Lt,{downloadUrl:e.downloadUrl,imageFile:e.file,source:i,loading:t||e.loading,copyDirection:p[n],onCopyToOtherClick:this.onCopyToOtherClick.bind(this,n),buttonPosition:o?"stack-right":qt[n]},o?[Object(c.b)(B,{class:h.expandIcon,key:"expand-icon"}),`${Ht[n]} (${bt[e.latestSettings.encoderState.type].label})`]:null)),d=s.encodedSettings||s.latestSettings,g=r.encodedSettings||r.latestSettings,m=d.preprocessorState.resize.enabled&&"contain"===d.preprocessorState.resize.fitMethod,f=g.preprocessorState.resize.enabled&&"contain"===g.preprocessorState.resize.fitMethod;return Object(c.b)("div",{class:h.compress},Object(c.b)(Y,{source:i,mobileView:o,leftCompressed:a,rightCompressed:l,leftImgContain:m,rightImgContain:f,onBack:e,inputProcessorState:i&&i.inputProcessorState,onInputProcessorChange:this.onInputProcessorChange}),o?Object(c.b)("div",{class:h.options},Object(c.b)("multi-panel",{class:h.multiPanel,"open-one-only":!0},b[0],u[0],b[1],u[1])):[Object(c.b)("div",{class:h.options,key:"options0"},u[0],b[0]),Object(c.b)("div",{class:h.options,key:"options1"},u[1],b[1])])}}Mt([l.b],Wt.prototype,"onMobileWidthChange",null),Mt([l.b],Wt.prototype,"onInputProcessorChange",null),Mt([l.b],Wt.prototype,"updateFile",null)}])]);
//# sourceMappingURL=main-app.8c16b.js.map